<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InterviewAce - AI Interview Copilot</title>
    <meta name="description" content="AI-powered interview preparation with live copilot assistance">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Space+Mono:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #ff6500;
            --primary-dark: #cc5100;
            --accent: #00ff88;
            --bg-dark: #0a0a0a;
            --bg-card: #1a1a1a;
            --bg-card-hover: #242424;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #6e6e6e;
            --border: #2a2a2a;
            --success: #00ff88;
            --warning: #ffaa00;
            --error: #ff3366;
        }
        
        body {
            font-family: 'Space Mono', monospace;
            background: var(--bg-dark);
            color: var(--text-primary);
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        .grain-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 9999;
            animation: grain 8s steps(10) infinite;
        }
        
        @keyframes grain {
            0%, 100% { transform: translate(0, 0); }
            10% { transform: translate(-5%, -10%); }
            30% { transform: translate(3%, -15%); }
            50% { transform: translate(12%, 9%); }
            70% { transform: translate(9%, 4%); }
            90% { transform: translate(-1%, 7%); }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .header {
            position: sticky;
            top: 0;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--border);
            padding: 20px 0;
            z-index: 1000;
        }
        
        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-family: 'Syne', sans-serif;
            font-size: 28px;
            font-weight: 800;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: -1px;
            cursor: pointer;
        }
        
        .nav-links {
            display: flex;
            gap: 30px;
            align-items: center;
        }
        
        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
        }
        
        .nav-link:hover, .nav-link.active {
            color: var(--primary);
        }
        
        .page-section {
            display: none;
            padding: 60px 0;
            min-height: calc(100vh - 80px);
        }
        
        .page-section.active {
            display: block;
        }
        
        .hero {
            padding: 100px 0 80px;
            text-align: center;
            position: relative;
        }
        
        .hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 20%, rgba(255, 101, 0, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 70% 80%, rgba(0, 255, 136, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        h1 {
            font-family: 'Syne', sans-serif;
            font-size: clamp(48px, 8vw, 96px);
            font-weight: 800;
            line-height: 1;
            margin-bottom: 30px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-subtitle {
            font-size: clamp(16px, 3vw, 20px);
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto 40px;
        }
        
        .btn {
            padding: 16px 40px;
            border: none;
            border-radius: 8px;
            font-family: 'Space Mono', monospace;
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary);
            color: var(--bg-dark);
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 101, 0, 0.3);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--border);
        }
        
        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-ghost {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 5px;
            transition: color 0.2s;
        }
        
        .btn-ghost:hover {
            color: var(--text-primary);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 60px;
        }
        
        .feature-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            transform: scaleX(0);
            transition: transform 0.3s;
        }
        
        .feature-card:hover {
            background: var(--bg-card-hover);
            border-color: var(--primary);
            transform: translateY(-4px);
        }
        
        .feature-card:hover::before {
            transform: scaleX(1);
        }
        
        .feature-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .feature-title {
            font-family: 'Syne', sans-serif;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .feature-description {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .section-header {
            margin-bottom: 40px;
        }
        
        .section-title {
            font-family: 'Syne', sans-serif;
            font-size: clamp(32px, 5vw, 48px);
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .section-description {
            color: var(--text-secondary);
            font-size: 16px;
        }
        
        /* Copilot Styles */
        .copilot-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .copilot-header {
            background: var(--bg-dark);
            border-bottom: 1px solid var(--border);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--text-secondary);
            transition: all 0.3s;
        }
        
        .status-dot.active {
            background: var(--success);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(0, 255, 136, 0.7); }
            50% { opacity: 0.8; box-shadow: 0 0 0 10px rgba(0, 255, 136, 0); }
        }
        
        .status-text {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            transition: color 0.3s;
        }
        
        .status-text.active {
            color: var(--success);
        }
        
        .copilot-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .control-btn:hover {
            border-color: var(--primary);
        }
        
        .control-btn.active {
            background: var(--primary);
            color: var(--bg-dark);
            border-color: var(--primary);
        }
        
        .copilot-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            min-height: 600px;
        }
        
        .conversation-area {
            padding: 30px;
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }
        
        .messages-container {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            max-height: 500px;
            padding-right: 10px;
            /* New messages appear at top, so we ensure container starts at top */
            scroll-behavior: smooth;
        }
        
        .message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .message.question {
            background: rgba(255, 101, 0, 0.1);
            border-left: 3px solid var(--primary);
        }
        
        .message.suggestion {
            background: rgba(0, 255, 136, 0.1);
            border-left: 3px solid var(--accent);
        }
        
        .message-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        
        .message-text {
            font-size: 14px;
            line-height: 1.6;
        }
        
        .input-area {
            display: flex;
            gap: 10px;
        }
        
        .message-input {
            flex: 1;
            padding: 12px 16px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 14px;
        }
        
        .message-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .sidebar {
            padding: 30px;
            background: var(--bg-dark);
            overflow-y: auto;
            max-height: 600px;
        }
        
        .sidebar-section {
            margin-bottom: 30px;
        }
        
        .sidebar-title {
            font-family: 'Syne', sans-serif;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .quick-answer {
            padding: 12px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
        }
        
        .quick-answer:hover {
            background: var(--bg-card-hover);
            border-color: var(--primary);
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
            font-size: 13px;
        }
        
        .stat-value {
            color: var(--accent);
            font-weight: 700;
        }

        /* Context Drawer Styles */
        .context-drawer {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            width: 380px;
            background: var(--bg-card);
            border-left: 1px solid var(--border);
            box-shadow: -10px 0 30px rgba(0,0,0,0.5);
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 25px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .context-drawer.open {
            transform: translateX(0);
        }

        .context-drawer .input {
            width: 100%;
            padding: 12px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 13px;
            resize: vertical;
            margin-bottom: 8px;
        }

        .context-drawer .input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .context-drawer .file-label {
            display: inline-block;
            padding: 8px 12px;
            background: var(--bg-dark);
            border: 1px dashed var(--border);
            border-radius: 4px;
            color: var(--text-secondary);
            font-size: 11px;
            cursor: pointer;
            margin-top: 5px;
            transition: all 0.2s;
        }

        .context-drawer .file-label:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        
        /* Resume Builder - Enhanced */
        .resume-input-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .voice-input-area {
            display: flex;
            gap: 15px;
            align-items: end;
            margin-bottom: 30px;
        }
        
        .voice-input-group {
            flex: 1;
        }
        
        .voice-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 10px;
            display: block;
        }
        
        .voice-textarea {
            width: 100%;
            min-height: 120px;
            padding: 16px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 14px;
            resize: vertical;
        }
        
        .voice-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .voice-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .mic-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--bg-dark);
            border: 2px solid var(--border);
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .mic-btn:hover {
            border-color: var(--primary);
            background: var(--primary);
            color: var(--bg-dark);
        }
        
        .mic-btn.recording {
            background: var(--error);
            border-color: var(--error);
            animation: pulse 1.5s infinite;
        }
        
        .resume-settings {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .setting-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }
        
        .setting-input, .setting-select {
            padding: 10px 12px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 14px;
        }
        
        .setting-input:focus, .setting-select:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .resumes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 30px;
        }
        
        /* ATS-Friendly Resume Designs */
        .resume-card {
            background: white;
            border-radius: 12px;
            padding: 50px 45px;
            color: #000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            min-height: 800px;
            font-family: Arial, sans-serif;
        }
        
        /* Design 1: Classic Professional */
        .resume-card.design-1 {
            border-top: 5px solid #2c3e50;
        }
        
        .resume-card.design-1 .resume-name {
            font-size: 32px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }
        
        .resume-card.design-1 .resume-title {
            font-size: 16px;
            color: #7f8c8d;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .resume-card.design-1 .resume-section-title {
            font-size: 14px;
            font-weight: bold;
            color: #2c3e50;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 25px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #2c3e50;
        }
        
        /* Design 2: Modern Minimal */
        .resume-card.design-2 {
            border-left: 4px solid #e74c3c;
            padding-left: 50px;
        }
        
        .resume-card.design-2 .resume-name {
            font-size: 36px;
            font-weight: 300;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .resume-card.design-2 .resume-title {
            font-size: 18px;
            color: #e74c3c;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .resume-card.design-2 .resume-section-title {
            font-size: 13px;
            font-weight: bold;
            color: #e74c3c;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 25px;
            margin-bottom: 12px;
        }
        
        /* Design 3: Corporate Blue */
        .resume-card.design-3 .resume-header {
            background: #34495e;
            color: white;
            margin: -50px -45px 30px -45px;
            padding: 40px 45px;
        }
        
        .resume-card.design-3 .resume-name {
            font-size: 34px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .resume-card.design-3 .resume-title {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .resume-card.design-3 .resume-contact {
            font-size: 13px;
            opacity: 0.85;
        }
        
        .resume-card.design-3 .resume-section-title {
            font-size: 14px;
            font-weight: bold;
            color: #34495e;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 25px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #34495e;
        }
        
        /* Design 4: Clean Green */
        .resume-card.design-4 {
            border-top: 3px solid #27ae60;
        }
        
        .resume-card.design-4 .resume-name {
            font-size: 30px;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 8px;
        }
        
        .resume-card.design-4 .resume-title {
            font-size: 16px;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .resume-card.design-4 .resume-section-title {
            font-size: 13px;
            font-weight: bold;
            color: #27ae60;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 25px;
            margin-bottom: 12px;
            padding-left: 12px;
            border-left: 3px solid #27ae60;
        }
        
        /* Design 5: Executive Orange */
        .resume-card.design-5 .resume-name {
            font-size: 34px;
            font-weight: bold;
            color: #d35400;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .resume-card.design-5 .resume-title {
            font-size: 15px;
            color: #7f8c8d;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 3px;
        }
        
        .resume-card.design-5 .resume-section-title {
            font-size: 14px;
            font-weight: bold;
            color: #d35400;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 25px;
            margin-bottom: 12px;
            padding-bottom: 5px;
            border-bottom: 1px solid #d35400;
        }
        
        /* Common Resume Elements */
        .resume-contact {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 20px;
            line-height: 1.8;
        }
        
        .resume-summary {
            font-size: 14px;
            line-height: 1.8;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: justify;
        }
        
        .resume-skills {
            font-size: 13px;
            line-height: 1.8;
            color: #2c3e50;
        }
        
        .resume-job {
            margin-bottom: 20px;
        }
        
        .resume-job-title {
            font-size: 15px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 3px;
        }
        
        .resume-job-company {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 3px;
        }
        
        .resume-job-date {
            font-size: 12px;
            color: #95a5a6;
            margin-bottom: 8px;
            font-style: italic;
        }
        
        .resume-card ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .resume-card li {
            font-size: 13px;
            line-height: 1.9;
            margin-bottom: 6px;
            color: #2c3e50;
        }
        
        .resume-education {
            margin-bottom: 15px;
        }
        
        .resume-degree {
            font-size: 14px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 3px;
        }
        
        .resume-school {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 3px;
        }
        
        .resume-edu-date {
            font-size: 12px;
            color: #95a5a6;
            font-style: italic;
        }
        
        .resume-actions {
            display: flex;
            gap: 10px;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 2px solid #ecf0f1;
        }
        
        .resume-actions .btn {
            flex: 1;
            padding: 12px;
            font-size: 12px;
        }
        
        .resume-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .generating-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 10, 10, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 20px;
            z-index: 10000;
            display: none;
        }
        
        .generating-overlay.active {
            display: flex;
        }
        
        .generating-text {
            font-size: 20px;
            color: var(--primary);
            font-family: 'Syne', sans-serif;
        }
        
        /* Settings Modal */
        .settings-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            padding: 20px;
        }
        
        .settings-overlay.active {
            display: flex;
        }
        
        .settings-modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .settings-header {
            padding: 30px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .settings-title {
            font-family: 'Syne', sans-serif;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: all 0.3s;
        }
        
        .close-btn:hover {
            background: var(--bg-card-hover);
            color: var(--primary);
        }
        
        .settings-content {
            padding: 30px;
        }
        
        .settings-section {
            margin-bottom: 30px;
        }
        
        .settings-section-title {
            font-family: 'Syne', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-section-desc {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .ai-provider-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .provider-card {
            padding: 16px;
            background: var(--bg-dark);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .provider-card:hover {
            border-color: var(--primary);
            background: var(--bg-card-hover);
        }
        
        .provider-card.active {
            border-color: var(--primary);
            background: rgba(255, 101, 0, 0.1);
        }
        
        .provider-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }
        
        .provider-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }
        
        .provider-model {
            font-size: 11px;
            color: var(--text-secondary);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-label {
            font-size: 13px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            display: block;
        }
        
        .input-field {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Space Mono', monospace;
            font-size: 13px;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .input-field[type="password"] {
            letter-spacing: 2px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-badge.active {
            background: rgba(0, 255, 136, 0.2);
            color: var(--success);
        }
        
        .status-badge.demo {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }
        
        .help-text {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 8px;
            line-height: 1.5;
        }
        
        .help-link {
            color: var(--primary);
            text-decoration: none;
        }
        
        .help-link:hover {
            text-decoration: underline;
        }
        
        .settings-footer {
            padding: 20px 30px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .settings-icon {
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.3s;
            color: var(--text-secondary);
        }
        
        .settings-icon:hover {
            background: var(--bg-card-hover);
            color: var(--primary);
        }
        
        @media (max-width: 968px) {
            .copilot-content {
                grid-template-columns: 1fr;
            }
            
            .conversation-area {
                border-right: none;
                border-bottom: 1px solid var(--border);
            }
            
            .resumes-grid {
                grid-template-columns: 1fr;
            }
            
            .resume-settings {
                grid-template-columns: 1fr;
            }
            
            .settings-modal {
                max-width: 100%;
            }
            
            .ai-provider-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .context-drawer {
                width: 100%;
            }
        }
        
        @media print {
            body {
                background: white;
            }
            
            .resume-card {
                box-shadow: none;
                padding: 0.5in;
                page-break-after: always;
            }
            
            .resume-actions, .resume-badge {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="grain-overlay"></div>
    <div class="generating-overlay" id="generatingOverlay">
        <div class="loading" style="width: 60px; height: 60px; border-width: 6px;"></div>
        <div class="generating-text">Generating Resumes...</div>
    </div>
    
    <!-- Settings Modal -->
    <div class="settings-overlay" id="settingsOverlay">
        <div class="settings-modal">
            <div class="settings-header">
                <div class="settings-title">‚öôÔ∏è Settings</div>
                <button class="close-btn" onclick="closeSettings()">√ó</button>
            </div>
            
            <div class="settings-content">
                <!-- Current Status -->
                <div class="settings-section">
                    <div class="settings-section-title">
                        Current Mode: <span id="currentMode" class="status-badge demo">Demo Mode</span>
                    </div>
                </div>
                
                <!-- AI Provider Selection -->
                <div class="settings-section">
                    <div class="settings-section-title">ü§ñ AI Provider</div>
                    <div class="settings-section-desc">
                        Select your preferred AI provider for intelligent interview responses
                    </div>
                    
                    <div class="ai-provider-grid">
                        <div class="provider-card" onclick="selectProvider('openai')" id="provider-openai">
                            <div class="provider-icon">üü¢</div>
                            <div class="provider-name">OpenAI</div>
                            <div class="provider-model">GPT-4</div>
                        </div>
                        
                        <div class="provider-card" onclick="selectProvider('anthropic')" id="provider-anthropic">
                            <div class="provider-icon">üü£</div>
                            <div class="provider-name">Anthropic</div>
                            <div class="provider-model">Claude 3.5</div>
                        </div>
                        
                        <div class="provider-card" onclick="selectProvider('google')" id="provider-google">
                            <div class="provider-icon">üîµ</div>
                            <div class="provider-name">Google</div>
                            <div class="provider-model">Gemini 3 Flash Preview</div>
                        </div>
                        
                        <div class="provider-card active" onclick="selectProvider('demo')" id="provider-demo">
                            <div class="provider-icon">üé≠</div>
                            <div class="provider-name">Demo</div>
                            <div class="provider-model">Pre-programmed</div>
                        </div>
                    </div>
                </div>
                
                <!-- API Key Input -->
                <div class="settings-section" id="apiKeySection">
                    <div class="settings-section-title">üîë API Key</div>
                    
                    <div class="input-group">
                        <label class="input-label">API Key</label>
                        <input 
                            type="password" 
                            class="input-field" 
                            id="apiKeyInput" 
                            placeholder="sk-..." 
                        />
                        <div class="help-text">
                            Your API key is stored locally in your browser and never sent to our servers.
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">Custom Model (Optional)</label>
                        <input 
                            type="text" 
                            class="input-field" 
                            id="modelInput" 
                            placeholder="gpt-4-turbo-preview" 
                        />
                        <div class="help-text" id="providerHelp">
                            Get your API key from: <a href="https://platform.openai.com/api-keys" target="_blank" class="help-link">OpenAI Dashboard</a>
                        </div>
                    </div>
                </div>
                
                <!-- System Prompt Customization -->
                <div class="settings-section">
                    <div class="settings-section-title">üí¨ AI Behavior</div>
                    
                    <div class="input-group">
                        <label class="input-label">System Prompt (Advanced)</label>
                        <textarea 
                            class="input-field" 
                            id="systemPromptInput" 
                            rows="4"
                            placeholder="You are an expert interview coach..."
                        ></textarea>
                        <div class="help-text">
                            Customize how the AI responds to interview questions. Leave empty for default.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="settings-footer">
                <button class="btn btn-secondary" onclick="clearSettings()">Clear All</button>
                <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
            </div>
        </div>
    </div>
    
    <header class="header">
        <div class="container">
            <div class="nav-content">
                <div class="logo" onclick="navigate('home')">InterviewAce</div>
                <nav class="nav-links">
                    <a class="nav-link active" onclick="navigate('home')">Home</a>
                    <a class="nav-link" onclick="navigate('copilot')">Live Copilot</a>
                    <a class="nav-link" onclick="navigate('resume')">Resume Builder</a>
                    <span class="settings-icon" onclick="openSettings()" title="Settings">‚öôÔ∏è</span>
                </nav>
            </div>
        </div>
    </header>
    
    <!-- Home Page -->
    <section id="home" class="page-section active">
        <div class="hero">
            <div class="hero-bg"></div>
            <div class="container">
                <div style="position: relative; z-index: 1; text-align: center;">
                    <h1>ACE YOUR<br>NEXT INTERVIEW</h1>
                    <p class="hero-subtitle">
                        AI-powered interview assistance with voice-enabled resume builder
                    </p>
                    <div style="display: flex; gap: 20px; justify-content: center; margin-top: 40px;">
                        <button class="btn btn-primary" onclick="navigate('copilot')">Start Live Copilot</button>
                        <button class="btn btn-secondary" onclick="navigate('resume')">Build Resumes</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="container">
            <div class="features-grid">
                <div class="feature-card" onclick="navigate('copilot')">
                    <div class="feature-icon">üéØ</div>
                    <h3 class="feature-title">Live Interview Copilot</h3>
                    <p class="feature-description">
                        Real-time voice recognition and AI assistance during interviews with stealth mode
                    </p>
                </div>
                
                <div class="feature-card" onclick="navigate('resume')">
                    <div class="feature-icon">üìÑ</div>
                    <h3 class="feature-title">Multi-Resume Generator</h3>
                    <p class="feature-description">
                        Generate multiple ATS-friendly resumes with different designs from one prompt
                    </p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">üé§</div>
                    <h3 class="feature-title">Voice Recognition</h3>
                    <p class="feature-description">
                        Hands-free operation with advanced speech-to-text for interviews and resume building
                    </p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Live Copilot Page -->
    <section id="copilot" class="page-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Live Interview Copilot</h2>
                <p class="section-description">Real-time AI assistance with voice recognition</p>
            </div>
            
            <div class="copilot-card">
                <div class="copilot-header">
                    <div class="status-indicator">
                        <div class="status-dot" id="statusDot"></div>
                        <span class="status-text" id="statusText">Standby</span>
                        <span style="margin-left: 15px; font-size: 11px; color: var(--text-secondary);">|</span>
                        <span id="aiModeIndicator" class="status-badge demo" style="margin-left: 15px; font-size: 10px;">Demo Mode</span>
                    </div>
                    <div class="copilot-controls">
                        <button class="control-btn" id="btnListen" onclick="toggleListen()"><i class="fa-solid fa-microphone"></i> Listening: OFF</button>
                        <button class="control-btn" id="btnStealth" onclick="toggleStealth()"><i class="fa-solid fa-eye-slash"></i> Stealth: OFF</button>
                        <button class="control-btn" id="btnType" onclick="cycleType()"><i class="fa-solid fa-briefcase"></i> Behavioral</button>
                        <button class="control-btn" id="btnContext" onclick="ui.toggleContext()"><i class="fa-solid fa-book"></i> Context</button>
                        <div style="font-size: 10px; color: var(--text-secondary); margin-top: 5px;">
                            Voice requires microphone permission
                        </div>
                    </div>
                </div>

                <!-- Context Drawer (New Feature) -->
                <div id="context-drawer" class="context-drawer">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                        <strong style="color:var(--text-primary); font-family:'Syne', sans-serif; font-size: 18px;">
                            <i class="fa-solid fa-book" style="color:var(--primary); margin-right: 8px;"></i> Context Data
                        </strong>
                        <button class="btn btn-ghost" onclick="ui.toggleContext(false)">
                            <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    </div>
                    
                    <div style="display:grid; gap:20px;">
                        <div>
                            <label style="font-size:0.75rem; font-weight:600; color:var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">YOUR RESUME</label>
                            <textarea id="ctx-resume" class="input" rows="6" placeholder="Paste resume text here..." oninput="state.saveContext()"></textarea>
                            <input type="file" id="file-resume" style="display:none" accept=".txt,.md,.json" onchange="fileHandler.read(this, 'ctx-resume')">
                            <label for="file-resume" class="file-label"><i class="fa-solid fa-upload"></i> Upload Resume File</label>
                        </div>
                        
                        <div>
                            <label style="font-size:0.75rem; font-weight:600; color:var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">JOB DESCRIPTION</label>
                            <textarea id="ctx-jd" class="input" rows="6" placeholder="Paste job description here..." oninput="state.saveContext()"></textarea>
                            <input type="file" id="file-jd" style="display:none" accept=".txt,.md,.json" onchange="fileHandler.read(this, 'ctx-jd')">
                            <label for="file-jd" class="file-label"><i class="fa-solid fa-upload"></i> Upload JD File</label>
                        </div>
                    </div>
                    
                    <div style="text-align:right; margin-top:20px; border-top: 1px solid var(--border); padding-top: 15px;">
                        <span id="context-status" style="font-size: 11px; color: var(--text-secondary); margin-right: 15px;">No data saved</span>
                        <button class="btn btn-primary" style="font-size:0.75rem; padding: 8px 16px;" onclick="ui.toggleContext(false)">Done</button>
                    </div>
                </div>
                
                <div class="copilot-content">
                    <div class="conversation-area">
                        <div class="messages-container" id="messages">
                            <div class="message suggestion">
                                <div class="message-label">Welcome</div>
                                <div class="message-text">
                                    <strong>Live Copilot Ready!</strong><br><br>
                                    <strong>‚öôÔ∏è Quick Start:</strong><br>
                                    1. Click the ‚öôÔ∏è Settings icon to configure AI (OpenAI, Claude, or Gemini)<br>
                                    2. Add your API key for unlimited intelligent responses<br>
                                    3. Or use Demo Mode with pre-programmed answers<br><br>
                                    <strong>üìù New Feature: Context Drawer</strong><br>
                                    Click the "Context" button above to upload your Resume and the Job Description. The AI will tailor answers specifically to your experience and the role!<br><br>
                                    <strong>Voice Features:</strong><br>
                                    ‚Ä¢ Click "üéôÔ∏è Listening: OFF" to enable voice recognition<br>
                                    ‚Ä¢ Enable "üëÅÔ∏è Stealth: OFF" for undetectable mode<br><br>
                                    <em>üí° Click ‚öôÔ∏è in the top-right to activate AI mode!</em>
                                </div>
                            </div>
                        </div>
                        
                        <div class="input-area">
                            <input type="text" class="message-input" id="queryInput" 
                                   placeholder="Type a question or enable voice recognition...">
                            <button class="btn btn-primary" onclick="sendQuery()">Send</button>
                        </div>
                    </div>
                    
                    <div class="sidebar">
                        <div class="sidebar-section">
                            <h4 class="sidebar-title">Quick Answers</h4>
                            <div class="quick-answer" onclick="quickAnswer('strength')">üí™ My Strengths</div>
                            <div class="quick-answer" onclick="quickAnswer('weakness')">üéØ My Weaknesses</div>
                            <div class="quick-answer" onclick="quickAnswer('why')">üè¢ Why This Company</div>
                            <div class="quick-answer" onclick="quickAnswer('achievement')">üèÜ Top Achievement</div>
                            <div class="quick-answer" onclick="quickAnswer('tosca')">üîß Tosca Experience</div>
                            <div class="quick-answer" onclick="quickAnswer('selenium')">ü§ñ Selenium Automation</div>
                            <div class="quick-answer" onclick="quickAnswer('api')">üì° API Testing</div>
                            <div class="quick-answer" onclick="quickAnswer('agile')">‚ö° Agile/Scrum</div>
                        </div>
                        
                        <div class="sidebar-section">
                            <h4 class="sidebar-title">Session Stats</h4>
                            <div class="stat-item">
                                <span>Questions Assisted</span>
                                <span class="stat-value" id="questionCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span>Duration</span>
                                <span class="stat-value" id="duration">00:00</span>
                            </div>
                            <div class="stat-item">
                                <span>Voice Active</span>
                                <span class="stat-value" id="voiceStatus">No</span>
                            </div>
                            <div class="stat-item">
                                <span>Stealth Mode</span>
                                <span class="stat-value" id="stealthStatus">Off</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Resume Builder Page -->
    <section id="resume" class="page-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Multi-Resume Generator</h2>
                <p class="section-description">Generate multiple ATS-friendly resumes with different designs</p>
            </div>
            
            <div class="resume-input-section">
                <h3 style="font-family: 'Syne', sans-serif; margin-bottom: 20px; color: var(--primary);">
                    Input Your Information
                </h3>
                
                <div class="voice-input-area">
                    <div class="voice-input-group">
                        <label class="voice-label">Describe Your Background (Voice or Type)</label>
                        <textarea class="voice-textarea" id="resumeInput" 
                            placeholder="Example: I'm a software engineer with 5 years experience in React and Node.js. I've led teams of 4 developers and built applications serving 2M users. My key achievements include improving performance by 45% and reducing infrastructure costs by $200k annually. I have a BS in Computer Science from Stanford."
                        ></textarea>
                    </div>
                    
                    <div class="voice-controls">
                        <button class="mic-btn" id="micBtn" onclick="toggleVoiceInput()" title="Click to speak">
                            üé§
                        </button>
                        <div style="font-size: 11px; text-align: center; color: var(--text-secondary);">
                            Voice<br>Input
                        </div>
                    </div>
                </div>
                
                <div class="resume-settings">
                    <div class="setting-group">
                        <label class="setting-label">Number of Variations</label>
                        <input type="number" class="setting-input" id="resumeCount" value="3" min="1" max="10">
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Resume Length</label>
                        <select class="setting-select" id="resumePages">
                            <option value="1">1 Page (Entry/Mid-Level)</option>
                            <option value="2">2 Pages (Senior)</option>
                            <option value="3">3 Pages (Executive/Academic)</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Target Role</label>
                        <input type="text" class="setting-input" id="targetRole" placeholder="e.g., Senior Software Engineer">
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="generateResumes()" style="width: 100%; padding: 18px;">
                    ‚ú® Generate ATS-Friendly Resumes
                </button>
            </div>
            
            <div class="resumes-grid" id="resumesGrid">
                <!-- Generated resumes will appear here -->
            </div>
        </div>
    </section>

    <script>
        // ========================================
        // State Management
        // ========================================
        const state = {
            currentPage: 'home',
            isListening: false,
            stealthMode: false,
            interviewType: 0,
            types: ['Behavioral', 'Technical', 'Case Study', 'Coding'],
            questionCount: 0,
            sessionStart: null,
            recognition: null,
            voiceRecognition: null,
            isRecording: false,
            recognitionRunning: false,
            aiSettings: {
                provider: 'demo',
                apiKey: '',
                model: '',
                systemPrompt: ''
            },
            // Context Data
            contextResume: '',
            contextJD: ''
        };
        
        // ========================================
        // UI Handlers (New Feature)
        // ========================================
        const ui = {
            toggleContext: function(forceState) {
                const drawer = document.getElementById('context-drawer');
                const btn = document.getElementById('btnContext');
                
                const isOpen = drawer.classList.contains('open');
                const shouldOpen = forceState !== undefined ? forceState : !isOpen;

                if (shouldOpen) {
                    drawer.classList.add('open');
                    btn.classList.add('active');
                } else {
                    drawer.classList.remove('open');
                    btn.classList.remove('active');
                }
            }
        };

        const fileHandler = {
            read: function(input, targetId) {
                const file = input.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById(targetId).value = e.target.result;
                    state.saveContext();
                    // Reset input so same file can be selected again if needed
                    input.value = ''; 
                };
                reader.readAsText(file);
            }
        };

        // Extend state with context saving
        state.saveContext = function() {
            state.contextResume = document.getElementById('ctx-resume').value;
            state.contextJD = document.getElementById('ctx-jd').value;
            
            const statusEl = document.getElementById('context-status');
            if (state.contextResume || state.contextJD) {
                statusEl.textContent = 'Context data saved';
                statusEl.style.color = 'var(--success)';
                
                // Persist to localStorage
                localStorage.setItem('interviewace_ctx_resume', state.contextResume);
                localStorage.setItem('interviewace_ctx_jd', state.contextJD);
            } else {
                statusEl.textContent = 'No data saved';
                statusEl.style.color = 'var(--text-muted)';
                localStorage.removeItem('interviewace_ctx_resume');
                localStorage.removeItem('interviewace_ctx_jd');
            }
        };

        function loadContext() {
            const savedResume = localStorage.getItem('interviewace_ctx_resume');
            const savedJD = localStorage.getItem('interviewace_ctx_jd');
            
            if (savedResume) {
                document.getElementById('ctx-resume').value = savedResume;
                state.contextResume = savedResume;
            }
            if (savedJD) {
                document.getElementById('ctx-jd').value = savedJD;
                state.contextJD = savedJD;
            }
            
            if (savedResume || savedJD) {
                document.getElementById('context-status').textContent = 'Context loaded from storage';
                document.getElementById('context-status').style.color = 'var(--success)';
            }
        }

        // ========================================
        // Settings Management
        // ========================================
        function loadSettings() {
            try {
                const saved = localStorage.getItem('interviewace_settings');
                if (saved) {
                    const settings = JSON.parse(saved);
                    state.aiSettings = { ...state.aiSettings, ...settings };
                    updateSettingsUI();
                    updateModeDisplay();
                }
                // Load context as well
                loadContext();
            } catch (e) {
                console.error('Error loading settings:', e);
            }
        }
        
        function saveSettings() {
            const provider = state.aiSettings.provider;
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            const model = document.getElementById('modelInput').value.trim();
            const systemPrompt = document.getElementById('systemPromptInput').value.trim();
            
            state.aiSettings = {
                provider,
                apiKey,
                model,
                systemPrompt
            };
            
            try {
                localStorage.setItem('interviewace_settings', JSON.stringify(state.aiSettings));
                updateModeDisplay();
                closeSettings();
                
                // Show success message
                const msg = apiKey ? 
                    `‚úÖ Settings saved! AI mode activated with ${getProviderName(provider)}` :
                    '‚úÖ Settings saved! Using demo mode (add API key to enable AI)';
                
                addMessage('suggestion', 'Settings Updated', msg);
            } catch (e) {
                alert('Error saving settings: ' + e.message);
            }
        }
        
        function clearSettings() {
            if (confirm('Clear all settings and return to demo mode?')) {
                localStorage.removeItem('interviewace_settings');
                localStorage.removeItem('interviewace_ctx_resume');
                localStorage.removeItem('interviewace_ctx_jd');
                
                state.aiSettings = {
                    provider: 'demo',
                    apiKey: '',
                    model: '',
                    systemPrompt: ''
                };
                
                // Clear context UI
                document.getElementById('ctx-resume').value = '';
                document.getElementById('ctx-jd').value = '';
                state.contextResume = '';
                state.contextJD = '';
                
                updateSettingsUI();
                updateModeDisplay();
                alert('Settings and context cleared!');
            }
        }
        
        function openSettings() {
            updateSettingsUI();
            document.getElementById('settingsOverlay').classList.add('active');
        }
        
        function closeSettings() {
            document.getElementById('settingsOverlay').classList.remove('active');
        }
        
        function selectProvider(provider) {
            state.aiSettings.provider = provider;
            
            // Update UI
            document.querySelectorAll('.provider-card').forEach(card => {
                card.classList.remove('active');
            });
            document.getElementById('provider-' + provider).classList.add('active');
            
            // Show/hide API key section
            const apiSection = document.getElementById('apiKeySection');
            if (provider === 'demo') {
                apiSection.style.display = 'none';
            } else {
                apiSection.style.display = 'block';
                updateProviderHelp(provider);
            }
        }
        
        function updateProviderHelp(provider) {
            const helpText = document.getElementById('providerHelp');
            const modelInput = document.getElementById('modelInput');
            
            const providerInfo = {
                openai: {
                    link: 'https://platform.openai.com/api-keys',
                    name: 'OpenAI Dashboard',
                    model: 'gpt-4-turbo-preview'
                },
                anthropic: {
                    link: 'https://console.anthropic.com/settings/keys',
                    name: 'Anthropic Console',
                    model: 'claude-3-5-sonnet-20241022'
                },
                google: {
                    link: 'https://makersuite.google.com/app/apikey',
                    name: 'Google AI Studio',
                    model: 'gemini-3-flash-preiew'
                }
            };
            
            const info = providerInfo[provider];
            if (info) {
                helpText.innerHTML = `Get your API key from: <a href="${info.link}" target="_blank" class="help-link">${info.name}</a>`;
                modelInput.placeholder = info.model;
            }
        }
        
        function updateSettingsUI() {
            const { provider, apiKey, model, systemPrompt } = state.aiSettings;
            
            // Update provider selection
            document.querySelectorAll('.provider-card').forEach(card => {
                card.classList.remove('active');
            });
            document.getElementById('provider-' + provider).classList.add('active');
            
            // Update inputs
            document.getElementById('apiKeyInput').value = apiKey;
            document.getElementById('modelInput').value = model;
            document.getElementById('systemPromptInput').value = systemPrompt;
            
            // Show/hide API section
            const apiSection = document.getElementById('apiKeySection');
            if (provider === 'demo') {
                apiSection.style.display = 'none';
            } else {
                apiSection.style.display = 'block';
                updateProviderHelp(provider);
            }
        }
        
        function updateModeDisplay() {
            const { provider, apiKey } = state.aiSettings;
            const modeDisplay = document.getElementById('currentMode');
            const copilotIndicator = document.getElementById('aiModeIndicator');
            
            if (provider === 'demo' || !apiKey) {
                // Demo mode
                if (modeDisplay) {
                    modeDisplay.textContent = 'Demo Mode';
                    modeDisplay.className = 'status-badge demo';
                }
                if (copilotIndicator) {
                    copilotIndicator.textContent = 'Demo Mode';
                    copilotIndicator.className = 'status-badge demo';
                }
            } else {
                // AI mode
                const providerName = getProviderName(provider);
                if (modeDisplay) {
                    modeDisplay.textContent = `AI: ${providerName}`;
                    modeDisplay.className = 'status-badge active';
                }
                if (copilotIndicator) {
                    copilotIndicator.textContent = `AI: ${providerName}`;
                    copilotIndicator.className = 'status-badge active';
                }
            }
        }
        
        function getProviderName(provider) {
            const names = {
                openai: 'OpenAI GPT-4',
                anthropic: 'Claude 3.5',
                google: 'Gemini 3 flash preview',
                demo: 'Demo'
            };
            return names[provider] || 'Unknown';
        }
        
        // ========================================
        // Navigation
        // ========================================
        function navigate(page) {
            document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
            document.getElementById(page).classList.add('active');
            
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
            event.target.classList.add('active');
            
            state.currentPage = page;
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            if (page === 'copilot' && !state.sessionStart) {
                state.sessionStart = Date.now();
                startTimer();
            }
            
            // Update mode display when navigating
            updateModeDisplay();
        }
        
        // ========================================
        // Live Copilot - Voice Recognition
        // ========================================
        function initSpeechRecognition() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                console.log('Speech recognition not supported');
                return null;
            }
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.lang = 'en-US';
            
            recognition.onstart = () => {
                console.log('Voice recognition started');
                state.recognitionRunning = true;
                document.getElementById('voiceStatus').textContent = 'Yes';
            };
            
            recognition.onresult = (event) => {
                let finalTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript + ' ';
                    }
                }
                
                if (finalTranscript) {
                    document.getElementById('queryInput').value = finalTranscript.trim();
                    clearTimeout(state.voiceTimeout);
                    state.voiceTimeout = setTimeout(() => {
                        if (document.getElementById('queryInput').value.trim()) {
                            sendQuery();
                        }
                    }, 1500);
                }
            };
            
            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event.error);
                state.recognitionRunning = false;
                
                if (event.error === 'not-allowed' || event.error === 'permission-denied') {
                    state.isListening = false;
                    const btn = document.getElementById('btnListen');
                    const dot = document.getElementById('statusDot');
                    const text = document.getElementById('statusText');
                    
                    btn.innerHTML = '<i class="fa-solid fa-microphone"></i> Listening: OFF';
                    btn.classList.remove('active');
                    dot.classList.remove('active');
                    text.classList.remove('active');
                    text.textContent = 'Standby';
                    
                    showPermissionError('copilot');
                } else if (event.error === 'aborted') {
                    // Normal abort, just log it
                    console.log('Recognition aborted (normal when stopping)');
                }
            };
            
            recognition.onend = () => {
                console.log('Recognition ended, isListening:', state.isListening);
                state.recognitionRunning = false;
                if (state.isListening) {
                    // Restart if still supposed to be listening
                    try {
                        recognition.start();
                    } catch (e) {
                        console.error('Could not restart recognition:', e);
                    }
                } else {
                    document.getElementById('voiceStatus').textContent = 'No';
                }
            };
            
            return recognition;
        }
        
        async function toggleListen() {
            const btn = document.getElementById('btnListen');
            const dot = document.getElementById('statusDot');
            const text = document.getElementById('statusText');
            
            if (!state.isListening) {
                // Turning ON - Request microphone permission first
                try {
                    await navigator.mediaDevices.getUserMedia({ audio: true });
                } catch (err) {
                    console.error('Microphone permission denied:', err);
                    showPermissionError('copilot');
                    return;
                }
                
                // Initialize recognition if needed
                if (!state.recognition) {
                    state.recognition = initSpeechRecognition();
                }
                
                if (!state.recognition) {
                    alert('Voice recognition is not supported in your browser. Please use Chrome, Edge, or Safari.');
                    return;
                }
                
                // Try to start recognition (only if not already running)
                if (!state.recognitionRunning) {
                    try {
                        state.recognition.start();
                        state.isListening = true;
                        btn.innerHTML = '<i class="fa-solid fa-microphone-lines"></i> Listening: ON';
                        btn.classList.add('active');
                        dot.classList.add('active');
                        text.classList.add('active');
                        text.textContent = 'Listening...';
                    } catch (e) {
                        console.error('Could not start recognition:', e);
                        showPermissionError('copilot');
                    }
                } else {
                    // Already running, just update UI
                    state.isListening = true;
                    btn.innerHTML = '<i class="fa-solid fa-microphone-lines"></i> Listening: ON';
                    btn.classList.add('active');
                    dot.classList.add('active');
                    text.classList.add('active');
                    text.textContent = 'Listening...';
                }
            } else {
                // Turning OFF
                state.isListening = false;
                if (state.recognition && state.recognitionRunning) {
                    try {
                        state.recognition.stop();
                    } catch (e) {
                        console.error('Error stopping recognition:', e);
                    }
                }
                btn.innerHTML = '<i class="fa-solid fa-microphone"></i> Listening: OFF';
                btn.classList.remove('active');
                dot.classList.remove('active');
                text.classList.remove('active');
                text.textContent = 'Standby';
            }
        }
        
        function showPermissionError(type) {
            const message = type === 'copilot' 
                ? 'Microphone access is required for voice recognition.\n\n' +
                  'How to enable:\n' +
                  '1. Click the üîí or üõ°Ô∏è icon in your browser address bar\n' +
                  '2. Find "Microphone" permissions\n' +
                  '3. Select "Allow"\n' +
                  '4. Reload the page\n\n' +
                  'Note: Voice features require HTTPS or localhost.\n' +
                  'You can still type questions manually!'
                : 'Microphone access is required for voice input.\n\n' +
                  'How to enable:\n' +
                  '1. Click the üîí or üõ°Ô∏è icon in your browser address bar\n' +
                  '2. Find "Microphone" permissions\n' +
                  '3. Select "Allow"\n' +
                  '4. Try voice input again\n\n' +
                  'You can still type your background information!';
            
            alert(message);
        }
        
        function toggleStealth() {
            state.stealthMode = !state.stealthMode;
            const btn = document.getElementById('btnStealth');
            
            if (state.stealthMode) {
                btn.innerHTML = '<i class="fa-solid fa-eye"></i> Stealth: ON';
                btn.classList.add('active');
                document.getElementById('stealthStatus').textContent = 'On';
                
                document.querySelector('.copilot-card').style.opacity = '0.3';
                document.querySelector('.copilot-card').style.transition = 'opacity 0.3s';
                
                addMessage('suggestion', 'Stealth Mode Activated', 
                    '‚úì Interface opacity reduced<br>‚úì Minimal screen footprint<br>‚úì Quick hide on ESC key<br>‚úì No notification sounds');
                
                document.addEventListener('keydown', handleStealthEscape);
            } else {
                btn.innerHTML = '<i class="fa-solid fa-eye-slash"></i> Stealth: OFF';
                btn.classList.remove('active');
                document.getElementById('stealthStatus').textContent = 'Off';
                
                document.querySelector('.copilot-card').style.opacity = '1';
                document.removeEventListener('keydown', handleStealthEscape);
            }
        }
        
        function handleStealthEscape(e) {
            if (e.key === 'Escape' && state.stealthMode) {
                navigate('home');
                addMessage('suggestion', 'Quick Hide', 'Stealth mode activated - navigated to home page');
            }
        }
        
        function cycleType() {
            state.interviewType = (state.interviewType + 1) % state.types.length;
            const icons = ['üíº', 'üíª', 'üìä', '‚öôÔ∏è'];
            document.getElementById('btnType').innerHTML = icons[state.interviewType] + ' ' + state.types[state.interviewType];
        }
        
        async function sendQuery() {
            const input = document.getElementById('queryInput');
            const query = input.value.trim();
            if (!query) return;
            
            addMessage('question', 'Your Question', query);
            state.questionCount++;
            document.getElementById('questionCount').textContent = state.questionCount;
            
            const loadingId = 'msg-' + Date.now();
            addMessage('suggestion', 'AI is thinking...', '<div class="loading"></div>', loadingId);
            
            input.value = '';
            
            // Check if AI is configured
            const { provider, apiKey } = state.aiSettings;
            
            if (provider !== 'demo' && apiKey) {
                // Use real AI API
                try {
                    const answer = await callAI(query);
                    document.getElementById(loadingId).remove();
                    addMessage('suggestion', 'AI Suggestion', answer);
                } catch (error) {
                    console.error('AI API error:', error);
                    document.getElementById(loadingId).remove();
                    addMessage('suggestion', 'Error', 
                        `<strong>‚ö†Ô∏è AI API Error:</strong><br><br>${error.message}<br><br>Falling back to demo mode...`);
                    // Fallback to demo response
                    setTimeout(() => {
                        addMessage('suggestion', 'Demo Response', getDemoResponse(query));
                    }, 500);
                }
            } else {
                // Use demo responses
                setTimeout(() => {
                    document.getElementById(loadingId).remove();
                    addMessage('suggestion', 'AI Suggestion', getDemoResponse(query));
                }, 1500);
            }
        }
        
        async function callAI(query) {
            const { provider, apiKey, model, systemPrompt } = state.aiSettings;
            
            let finalSystemPrompt = systemPrompt || `You are an expert interview coach helping a candidate prepare for job interviews. 
Provide detailed, professional answers using the STAR method (Situation, Task, Action, Result) when appropriate. 
Include specific examples, metrics, and quantifiable results. 
Make responses sound like they come from an experienced professional, not generic advice.
Keep responses concise but comprehensive (200-300 words).`;

            // Inject Context if available
            if (state.contextResume) {
                finalSystemPrompt += `\n\nCANDIDATE RESUME CONTEXT:\n${state.contextResume}`;
            }
            if (state.contextJD) {
                finalSystemPrompt += `\n\nTARGET JOB DESCRIPTION:\n${state.contextJD}`;
            }
            if (state.contextResume || state.contextJD) {
                finalSystemPrompt += `\n\nINSTRUCTION: Use the provided Resume and Job Description to tailor your answers. Highlight specific experience from the resume that matches the job requirements.`;
            }
            
            if (provider === 'openai') {
                return await callOpenAI(query, finalSystemPrompt, apiKey, model);
            } else if (provider === 'anthropic') {
                return await callAnthropic(query, finalSystemPrompt, apiKey, model);
            } else if (provider === 'google') {
                return await callGoogle(query, finalSystemPrompt, apiKey, model);
            }
            
            throw new Error('Invalid AI provider');
        }
        
        async function callOpenAI(query, systemPrompt, apiKey, customModel) {
            const model = customModel || 'gpt-4-turbo-preview';
            
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: model,
                    messages: [
                        { role: 'system', content: systemPrompt },
                        { role: 'user', content: query }
                    ],
                    temperature: 0.7,
                    max_tokens: 800
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'OpenAI API request failed');
            }
            
            const data = await response.json();
            return formatAIResponse(data.choices[0].message.content);
        }
        
        async function callAnthropic(query, systemPrompt, apiKey, customModel) {
            const model = customModel || 'claude-3-5-sonnet-20241022';
            
            const response = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-api-key': apiKey,
                    'anthropic-version': '2023-06-01'
                },
                body: JSON.stringify({
                    model: model,
                    max_tokens: 1024,
                    system: systemPrompt,
                    messages: [
                        { role: 'user', content: query }
                    ]
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'Anthropic API request failed');
            }
            
            const data = await response.json();
            return formatAIResponse(data.content[0].text);
        }
        
        async function callGoogle(query, systemPrompt, apiKey, customModel) {
            const model = customModel || 'gemini-3-flash-preview';
            
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: `${systemPrompt}\n\nUser question: ${query}`
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        maxOutputTokens: 800
                    }
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'Google API request failed');
            }
            
            const data = await response.json();
            return formatAIResponse(data.candidates[0].content.parts[0].text);
        }
        
        function formatAIResponse(text) {
            // Convert markdown-style formatting to HTML
            let formatted = text;
            
            // Bold
            formatted = formatted.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
            
            // Line breaks
            formatted = formatted.replace(/\n/g, '<br>');
            
            // Bullet points
            formatted = formatted.replace(/^- (.+)$/gm, '‚Ä¢ $1');
            
            return formatted;
        }
        
        function addMessage(type, label, text, id) {
            const msg = document.createElement('div');
            msg.className = 'message ' + type;
            if (id) msg.id = id;
            msg.innerHTML = '<div class="message-label">' + label + '</div><div class="message-text">' + text + '</div>';
            
            const container = document.getElementById('messages');
            // MODIFIED: Prepend instead of append to show latest at top
            container.prepend(msg);
            
            // No need to scroll to bottom anymore since we are at the top.
            // However, we ensure the container starts at the top (0) just in case.
            container.scrollTop = 0;
        }
        
        function getDemoResponse(query) {
            const lower = query.toLowerCase();
            
            // Check if context is present (even in demo mode, acknowledge it)
            let contextPrefix = '';
            if (state.contextResume || state.contextJD) {
                contextPrefix = '<strong>[Context Detected]:</strong> I see you have provided resume/job description data. In AI mode, I would use this to tailor the answer specifically to your experience. Below is a general STAR response:<br><br>';
            }
            
            // Behavioral questions
            if (lower.includes('strength')) {
                return contextPrefix + '<strong>STAR Response:</strong><br><br><strong>Situation:</strong> In my current role at TechCorp, our team needed to adopt a new technology stack within 3 months.<br><br><strong>Task:</strong> As senior engineer, I was responsible for learning React and training the team.<br><br><strong>Action:</strong> I dedicated evenings to learning, created internal documentation, and ran weekly workshops. I also built proof-of-concept projects to demonstrate best practices.<br><br><strong>Result:</strong> We successfully migrated on time, and our app performance improved by 35%. Team satisfaction increased as they felt confident with the new stack.';
            }
            if (lower.includes('weakness')) {
                return contextPrefix + '<strong>Honest + Growth Mindset:</strong><br><br>My weakness is that I can be overly detail-oriented, which sometimes slows down initial progress. For example, I once spent 3 days perfecting a minor feature when "good enough" would have sufficed.<br><br><strong>How I\'m Improving:</strong> I now use the 80/20 rule - I identify the 20% of work that delivers 80% of value and prioritize that. I set time-boxes for tasks and get feedback early. This has helped me ship faster while maintaining quality.';
            }
            if (lower.includes('why')) {
                return contextPrefix + '<strong>Research + Alignment:</strong><br><br>I\'m genuinely excited about this opportunity for three reasons:<br><br>1. <strong>Mission:</strong> Your company\'s focus on [specific product/mission] aligns with my passion for building impactful solutions.<br><br>2. <strong>Technology:</strong> You\'re using cutting-edge tech like [specific tech stack], which I\'ve been mastering and want to apply at scale.<br><br>3. <strong>Growth:</strong> Your culture of innovation and your recent [achievement/launch] shows this is a place where I can grow while contributing meaningfully.';
            }
            if (lower.includes('achievement')) {
                return contextPrefix + '<strong>STAR Response:</strong><br><br><strong>Situation:</strong> Our legacy monolithic system was causing 2-hour deployments and frequent downtime.<br><br><strong>Task:</strong> I proposed and led a migration to microservices architecture.<br><br><strong>Action:</strong> Over 6 months, I broke down the monolith, set up CI/CD pipelines, implemented monitoring, and trained the team on the new architecture.<br><br><strong>Result:</strong> We reduced deployment time from 2 hours to 15 minutes, cut downtime by 80%, and saved $200k annually in infrastructure costs. The project became a template for other teams.';
            }
            
            // Technical questions - Test Automation & Tools
            if (lower.includes('tosca')) {
                if (lower.includes('test data')) {
                    return contextPrefix + '<strong>Tosca Test Data Management:</strong><br><br>Test Data Management in Tosca involves systematically creating, managing, and maintaining test data for automated testing. Here\'s my experience:<br><br><strong>Key Components:</strong><br>‚Ä¢ <strong>Test Data Service (TDS):</strong> Centralized repository for test data that can be provisioned on-demand<br>‚Ä¢ <strong>Data Integrity:</strong> Ensures test data is consistent and valid across test cycles<br>‚Ä¢ <strong>Data Provisioning:</strong> Automatically generates test data matching production-like scenarios<br><br><strong>My Approach:</strong><br>1. Created reusable test data templates in TDS<br>2. Implemented data subsetting to create smaller, manageable datasets<br>3. Used Tosca\'s data-driven testing to parameterize test cases<br>4. Set up automated data refresh before each test cycle<br><br><strong>Results:</strong> Reduced test data preparation time by 60% and improved test reliability by 40%.';
                }
                return contextPrefix + '<strong>Tosca Experience:</strong><br><br>I have extensive experience with Tricentis Tosca for test automation:<br><br>‚Ä¢ <strong>Model-Based Testing:</strong> Created reusable test case modules using Tosca Commander<br>‚Ä¢ <strong>API Testing:</strong> Automated REST/SOAP API validation<br>‚Ä¢ <strong>SAP Testing:</strong> Automated complex SAP workflows end-to-end<br>‚Ä¢ <strong>CI/CD Integration:</strong> Integrated Tosca with Jenkins for continuous testing<br><br>Reduced regression testing time from 2 weeks to 3 days using Tosca automation.';
            }
            
            if (lower.includes('selenium')) {
                return contextPrefix + '<strong>Selenium Expertise:</strong><br><br><strong>Situation:</strong> Our web application had 200+ manual test cases taking 3 weeks per release.<br><br><strong>Task:</strong> Implement Selenium automation framework to reduce testing time.<br><br><strong>Action:</strong><br>‚Ä¢ Built Page Object Model framework using Selenium WebDriver with Java<br>‚Ä¢ Implemented TestNG for test organization and parallel execution<br>‚Ä¢ Created reusable utility libraries for common actions<br>‚Ä¢ Integrated with Jenkins for nightly test runs<br>‚Ä¢ Set up detailed HTML reporting with screenshots<br><br><strong>Result:</strong> Automated 85% of regression suite, reduced testing from 3 weeks to 4 hours, caught 40% more bugs pre-release.';
            }
            
            if (lower.includes('api') && (lower.includes('test') || lower.includes('automation'))) {
                return contextPrefix + '<strong>API Testing Experience:</strong><br><br><strong>Situation:</strong> Microservices architecture with 50+ APIs needing comprehensive testing.<br><br><strong>Task:</strong> Design and implement automated API testing strategy.<br><br><strong>Action:</strong><br>‚Ä¢ Used Postman/Newman for REST API automation<br>‚Ä¢ Implemented contract testing with Pact<br>‚Ä¢ Created data-driven tests with JSON/CSV files<br>‚Ä¢ Validated response schemas, status codes, and performance<br>‚Ä¢ Set up monitoring for API health checks<br><br><strong>Result:</strong> Achieved 95% API test coverage, detected integration issues 3 days earlier, reduced API defects in production by 70%.';
            }
            
            // Programming & Technical Concepts
            if (lower.includes('oops') || lower.includes('object oriented')) {
                return contextPrefix + '<strong>OOP Principles - Real-World Application:</strong><br><br>I use OOP daily in my automation frameworks:<br><br><strong>1. Encapsulation:</strong> Page Object classes hide WebDriver implementation details<br><br><strong>2. Inheritance:</strong> Base test class with common setup/teardown, extended by specific test classes<br><br><strong>3. Polymorphism:</strong> Different driver implementations (Chrome, Firefox) using same interface<br><br><strong>4. Abstraction:</strong> Abstract BasePage class defining common page operations<br><br><strong>Example:</strong> Built framework where test writers don\'t need to know WebDriver - they just call page.login(user, pass). This reduced onboarding time by 50%.';
            }
            
            if (lower.includes('sql') || lower.includes('database')) {
                return contextPrefix + '<strong>SQL & Database Testing:</strong><br><br><strong>Situation:</strong> Data validation was manual and error-prone.<br><br><strong>Task:</strong> Automate database validation in test framework.<br><br><strong>Action:</strong><br>‚Ä¢ Wrote SQL queries to validate data transformations<br>‚Ä¢ Used JDBC to connect tests to database<br>‚Ä¢ Implemented assertions comparing UI data with DB<br>‚Ä¢ Created stored procedure tests<br>‚Ä¢ Validated data integrity constraints<br><br><strong>Key Queries I Use:</strong><br>‚Ä¢ JOIN operations to validate relationships<br>‚Ä¢ Aggregate functions for data summaries<br>‚Ä¢ Window functions for complex analytics<br><br><strong>Result:</strong> Caught 30% more data-related defects, reduced validation time by 80%.';
            }
            
            if (lower.includes('agile') || lower.includes('scrum')) {
                return contextPrefix + '<strong>Agile/Scrum Experience:</strong><br><br>I\'ve worked in Agile teams for 5+ years:<br><br><strong>My Role:</strong><br>‚Ä¢ Participated in daily standups, sprint planning, and retrospectives<br>‚Ä¢ Collaborated with PO to refine acceptance criteria<br>‚Ä¢ Estimated testing effort during sprint planning<br>‚Ä¢ Automated regression tests within same sprint as development<br><br><strong>Key Achievement:</strong><br>Implemented "shift-left" testing approach where I paired with developers during coding, catching issues before QA phase. This reduced sprint defects by 45% and improved sprint velocity by 25%.';
            }
            
            // CI/CD & DevOps
            if (lower.includes('ci/cd') || lower.includes('jenkins') || lower.includes('pipeline')) {
                return contextPrefix + '<strong>CI/CD Implementation:</strong><br><br><strong>Situation:</strong> Tests were run manually, delaying feedback by days.<br><br><strong>Task:</strong> Integrate automated tests into CI/CD pipeline.<br><br><strong>Action:</strong><br>‚Ä¢ Set up Jenkins pipeline for automated test execution<br>‚Ä¢ Configured parallel test execution across multiple environments<br>‚Ä¢ Implemented automatic notifications on Slack/Email<br>‚Ä¢ Created detailed test reports with trends<br>‚Ä¢ Set up smoke tests on every commit, full regression nightly<br><br><strong>Result:</strong> Reduced feedback time from 2 days to 30 minutes, increased deployment frequency from weekly to daily, improved team confidence in releases.';
            }
            
            // Testing Methodologies
            if (lower.includes('test case') || lower.includes('test scenario')) {
                return contextPrefix + '<strong>Test Case Design:</strong><br><br>I follow systematic approach to test case creation:<br><br><strong>Techniques:</strong><br>‚Ä¢ <strong>Boundary Value Analysis:</strong> Test edge cases and limits<br>‚Ä¢ <strong>Equivalence Partitioning:</strong> Group similar inputs<br>‚Ä¢ <strong>Decision Tables:</strong> Cover complex business rules<br>‚Ä¢ <strong>State Transition:</strong> Test workflows and state changes<br><br><strong>Example:</strong> For a payment form, I test:<br>- Valid amounts (positive cases)<br>- Boundary values ($0.01, $999,999.99)<br>- Invalid inputs (negative, letters, special chars)<br>- State transitions (pending ‚Üí processing ‚Üí complete)<br><br><strong>Result:</strong> Achieved 98% requirement coverage with optimized test suite.';
            }
            
            if (lower.includes('bug') || lower.includes('defect')) {
                return contextPrefix + '<strong>Defect Management:</strong><br><br><strong>Situation:</strong> Team was overwhelmed with bug reports lacking critical information.<br><br><strong>Task:</strong> Improve defect reporting process and quality.<br><br><strong>Action:</strong><br>‚Ä¢ Created detailed bug report template with: steps to reproduce, expected vs actual results, screenshots, environment details, severity/priority<br>‚Ä¢ Established severity/priority guidelines<br>‚Ä¢ Implemented bug triage meetings<br>‚Ä¢ Used JIRA with custom workflows<br><br><strong>Bug Report Quality Metrics:</strong><br>- 95% of bugs resolved on first attempt (up from 60%)<br>- Average resolution time decreased 40%<br>- Developer satisfaction with bug reports improved significantly';
            }
            
            // Soft Skills & Scenarios
            if (lower.includes('conflict') || lower.includes('disagree')) {
                return contextPrefix + '<strong>Handling Conflict:</strong><br><br><strong>Situation:</strong> Developer disagreed with my bug report, claiming it was "working as designed."<br><br><strong>Task:</strong> Resolve disagreement while maintaining good relationship.<br><br><strong>Action:</strong><br>‚Ä¢ Scheduled 1-on-1 meeting to discuss calmly<br>‚Ä¢ Brought requirement documents and user stories<br>‚Ä¢ Demonstrated the issue from end-user perspective<br>‚Ä¢ Listened to developer\'s constraints and concerns<br>‚Ä¢ Together found a solution that met requirements without major rework<br><br><strong>Result:</strong> Issue was resolved, relationship strengthened, and we established better communication process for future issues.';
            }
            
            if (lower.includes('deadline') || lower.includes('pressure')) {
                return contextPrefix + '<strong>Working Under Pressure:</strong><br><br><strong>Situation:</strong> Critical production bug found 1 day before major release to 1M users.<br><br><strong>Task:</strong> Verify fix and ensure no regressions in 24 hours.<br><br><strong>Action:</strong><br>‚Ä¢ Immediately prioritized critical path testing<br>‚Ä¢ Ran automated regression suite in parallel<br>‚Ä¢ Coordinated with developers for rapid fix deployment<br>‚Ä¢ Performed exploratory testing of affected areas<br>‚Ä¢ Set up production monitoring for early detection<br><br><strong>Result:</strong> Verified fix within 8 hours, completed full regression testing, release went smoothly with zero production issues. Received commendation from leadership.';
            }
            
            if (lower.includes('learn') && lower.includes('new')) {
                return contextPrefix + '<strong>Learning New Technology:</strong><br><br><strong>Situation:</strong> Company decided to move from manual to automation testing using tools I\'d never used.<br><br><strong>Task:</strong> Learn Selenium and Java within 2 months to automate regression suite.<br><br><strong>Action:</strong><br>‚Ä¢ Completed online courses (Udemy, Pluralsight)<br>‚Ä¢ Built personal projects to practice<br>‚Ä¢ Paired with experienced automation engineers<br>‚Ä¢ Read documentation and best practices<br>‚Ä¢ Started small - automated 5 simple tests, then gradually increased complexity<br><br><strong>Result:</strong> Became team\'s automation lead within 6 months, mentored 3 junior testers, automated 200+ test cases with 95% pass rate.';
            }
            
            // Default response based on question type
            if (lower.includes('what is') || lower.includes('define') || lower.includes('explain')) {
                return (contextPrefix || '<strong>‚ö†Ô∏è DEMO MODE - Limited Response</strong><br><br>') + 'This is a demo with pre-programmed responses. For this technical question, I would provide:<br><br><strong>In Production:</strong><br>‚Ä¢ Detailed technical explanation<br>‚Ä¢ Real-world examples from my experience<br>‚Ä¢ Specific tools and technologies used<br>‚Ä¢ Quantifiable results and outcomes<br><br><strong>Current Demo Answers Available:</strong><br>‚úì Tosca & test data management<br>‚úì Selenium automation<br>‚úì API testing<br>‚úì SQL/Database testing<br>‚úì CI/CD & Jenkins<br>‚úì Agile/Scrum<br>‚úì OOP concepts<br>‚úì Test case design<br>‚úì Conflict resolution<br><br><em>üí° Try asking about these topics, or questions about strengths, weaknesses, achievements!</em>';
            }
            
            // General STAR framework
            return contextPrefix + '<strong>STAR Response Framework:</strong><br><br>For behavioral and technical questions, I use the STAR method:<br><br><strong>Situation:</strong> Briefly describe the context or challenge you faced.<br><br><strong>Task:</strong> Explain your specific responsibility or goal in that situation.<br><br><strong>Action:</strong> Detail the concrete steps you took to address the challenge. Be specific about YOUR actions.<br><br><strong>Result:</strong> Share measurable outcomes. Use numbers when possible (e.g., "increased by 40%", "reduced from 2 days to 4 hours", "saved $50k").<br><br><em>üí° Tip: Ask me specific questions about Tosca, Selenium, API testing, Agile, SQL, or behavioral topics for detailed answers!</em>';
        }
        
        function quickAnswer(type) {
            const questions = {
                'strength': 'What is your greatest strength?',
                'weakness': 'What is your greatest weakness?',
                'why': 'Why do you want to work here?',
                'achievement': 'What is your biggest achievement?',
                'tosca': 'What is your experience with Tosca test automation?',
                'selenium': 'Tell me about your Selenium automation experience',
                'api': 'Describe your API testing experience',
                'agile': 'How do you work in Agile/Scrum environment?'
            };
            document.getElementById('queryInput').value = questions[type];
            sendQuery();
        }
        
        function startTimer() {
            setInterval(() => {
                if (state.sessionStart) {
                    const elapsed = Date.now() - state.sessionStart;
                    const mins = Math.floor(elapsed / 60000);
                    const secs = Math.floor((elapsed % 60000) / 1000);
                    document.getElementById('duration').textContent = 
                        String(mins).padStart(2, '0') + ':' + String(secs).padStart(2, '0');
                }
            }, 1000);
        }
        
        // ========================================
        // Resume Builder - Voice Input
        // ========================================
        async function toggleVoiceInput() {
            const btn = document.getElementById('micBtn');
            
            if (!state.isRecording) {
                // Request microphone permission first
                try {
                    await navigator.mediaDevices.getUserMedia({ audio: true });
                } catch (err) {
                    showPermissionError('resume');
                    return;
                }
                
                if (!state.voiceRecognition) {
                    state.voiceRecognition = initResumeVoiceRecognition();
                }
                
                if (state.voiceRecognition) {
                    try {
                        state.voiceRecognition.start();
                        state.isRecording = true;
                        btn.classList.add('recording');
                        btn.textContent = '‚èπÔ∏è';
                    } catch (e) {
                        console.error('Voice input error:', e);
                        showPermissionError('resume');
                    }
                } else {
                    alert('Voice recognition is not supported in your browser. Please use Chrome, Edge, or Safari.');
                }
            } else {
                if (state.voiceRecognition) {
                    state.voiceRecognition.stop();
                }
                state.isRecording = false;
                btn.classList.remove('recording');
                btn.textContent = 'üé§';
            }
        }
        
        function initResumeVoiceRecognition() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                return null;
            }
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.lang = 'en-US';
            
            let finalTranscript = '';
            
            recognition.onresult = (event) => {
                let interimTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript + ' ';
                    } else {
                        interimTranscript += transcript;
                    }
                }
                
                document.getElementById('resumeInput').value = finalTranscript + interimTranscript;
            };
            
            recognition.onend = () => {
                state.isRecording = false;
                document.getElementById('micBtn').classList.remove('recording');
                document.getElementById('micBtn').textContent = 'üé§';
            };
            
            return recognition;
        }
        
        // ========================================
        // Resume Generation
        // ========================================
        async function generateResumes() {
            const input = document.getElementById('resumeInput').value.trim();
            const count = parseInt(document.getElementById('resumeCount').value) || 3;
            const pages = parseInt(document.getElementById('resumePages').value) || 1;
            const targetRole = document.getElementById('targetRole').value.trim();
            
            if (!input) {
                alert('Please provide your background information first (voice or text).');
                return;
            }
            
            if (count < 1 || count > 10) {
                alert('Please enter a number between 1 and 10.');
                return;
            }
            
            document.getElementById('generatingOverlay').classList.add('active');
            document.getElementById('resumesGrid').innerHTML = '';
            
            for (let i = 0; i < count; i++) {
                await generateSingleResume(input, i + 1, count, pages, targetRole);
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            document.getElementById('generatingOverlay').classList.remove('active');
        }
        
        async function generateSingleResume(input, index, total, pages, targetRole) {
            const designs = ['design-1', 'design-2', 'design-3', 'design-4', 'design-5'];
            const designClass = designs[(index - 1) % designs.length];
            
            const focusAreas = [
                'Technical Skills & Architecture',
                'Leadership & Team Management',
                'Achievements & Metrics',
                'Problem-Solving & Innovation',
                'Collaboration & Communication'
            ];
            
            const focus = focusAreas[(index - 1) % focusAreas.length];
            
            const resume = generateResumeHTML(input, designClass, focus, index, pages, targetRole);
            
            const grid = document.getElementById('resumesGrid');
            const card = document.createElement('div');
            card.className = `resume-card ${designClass}`;
            card.innerHTML = resume;
            grid.appendChild(card);
        }
        
        function generateResumeHTML(input, designClass, focus, index, pages, targetRole) {
            const name = extractName(input) || 'Alex Thompson';
            const title = targetRole || extractTitle(input) || 'Software Engineer';
            const experience = extractExperience(input) || '5+ years';
            const skills = extractSkills(input);
            const email = 'alex.thompson@email.com';
            const phone = '+1 (555) 123-4567';
            const linkedin = 'linkedin.com/in/alexthompson';
            
            let resumeContent = '';
            
            // Design-specific headers
            if (designClass === 'design-3') {
                resumeContent += `
                    <div class="resume-header">
                        <div class="resume-name">${name.toUpperCase()}</div>
                        <div class="resume-title">${title}</div>
                        <div class="resume-contact">${email} | ${phone} | ${linkedin}</div>
                    </div>
                `;
            } else {
                resumeContent += `
                    <div class="resume-name">${name}</div>
                    <div class="resume-title">${title}</div>
                    <div class="resume-contact">${email} | ${phone} | ${linkedin}</div>
                `;
            }
            
            // Professional Summary
            resumeContent += `
                <div class="resume-section-title">PROFESSIONAL SUMMARY</div>
                <div class="resume-summary">${generateSummary(input, focus, experience)}</div>
            `;
            
            // Core Competencies
            resumeContent += `
                <div class="resume-section-title">CORE COMPETENCIES</div>
                <div class="resume-skills">${skills.join(' ‚Ä¢ ')}</div>
            `;
            
            // Professional Experience
            resumeContent += `
                <div class="resume-section-title">PROFESSIONAL EXPERIENCE</div>
            `;
            
            const jobs = generateExperience(input, focus, pages);
            jobs.forEach(job => {
                resumeContent += `
                    <div class="resume-job">
                        <div class="resume-job-title">${job.title}</div>
                        <div class="resume-job-company">${job.company}</div>
                        <div class="resume-job-date">${job.dates}</div>
                        <ul>
                            ${job.bullets.map(b => `<li>${b}</li>`).join('')}
                        </ul>
                    </div>
                `;
            });
            
            // Education
            resumeContent += `
                <div class="resume-section-title">EDUCATION</div>
                <div class="resume-education">
                    <div class="resume-degree">Bachelor of Science in Computer Science</div>
                    <div class="resume-school">Stanford University</div>
                    <div class="resume-edu-date">Graduated: May 2019</div>
                </div>
            `;
            
            // Additional sections for 2+ page resumes
            if (pages >= 2) {
                resumeContent += `
                    <div class="resume-section-title">CERTIFICATIONS</div>
                    <ul>
                        <li>AWS Certified Solutions Architect ‚Äì Professional</li>
                        <li>Certified Kubernetes Administrator (CKA)</li>
                        <li>Google Cloud Professional Developer</li>
                    </ul>
                `;
            }
            
            if (pages >= 3) {
                resumeContent += `
                    <div class="resume-section-title">PUBLICATIONS & SPEAKING</div>
                    <ul>
                        <li>"Scalable Microservices Architecture" - Tech Conference 2024</li>
                        <li>"Modern DevOps Practices" - Industry Journal, 2023</li>
                    </ul>
                    
                    <div class="resume-section-title">PROFESSIONAL AFFILIATIONS</div>
                    <ul>
                        <li>Association for Computing Machinery (ACM) - Member since 2019</li>
                        <li>IEEE Computer Society - Active Member</li>
                    </ul>
                `;
            }
            
            // Actions
            resumeContent += `
                <div class="resume-actions">
                    <button class="btn btn-primary" onclick="downloadResume(${index})">üì• Download PDF</button>
                    <button class="btn btn-secondary" onclick="editResume(${index})">‚úèÔ∏è Customize</button>
                </div>
                <div class="resume-badge">${pages} Page ‚Ä¢ ${focus}</div>
            `;
            
            return resumeContent;
        }
        
        function extractName(input) {
            const nameMatch = input.match(/(?:I'm|I am|my name is)\s+([A-Z][a-z]+\s+[A-Z][a-z]+)/i);
            if (nameMatch) return nameMatch[1];
            
            const words = input.split(' ').slice(0, 2);
            return words.map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase()).join(' ');
        }
        
        function extractTitle(input) {
            const titles = [
                'Software Engineer', 'Full Stack Developer', 'Backend Engineer', 
                'Frontend Developer', 'DevOps Engineer', 'Data Engineer',
                'Senior Software Engineer', 'Lead Developer', 'Engineering Manager'
            ];
            for (let title of titles) {
                if (input.toLowerCase().includes(title.toLowerCase())) {
                    return title;
                }
            }
            return 'Software Engineer';
        }
        
        function extractExperience(input) {
            const match = input.match(/(\d+)\s*(?:\+)?\s*(?:year|yr)s?/i);
            return match ? `${match[1]}+ years` : '5+ years';
        }
        
        function extractSkills(input) {
            const allSkills = [
                'React', 'Node.js', 'Python', 'JavaScript', 'TypeScript', 'AWS', 
                'Docker', 'Kubernetes', 'PostgreSQL', 'MongoDB', 'GraphQL', 'REST APIs',
                'CI/CD', 'Agile', 'Leadership', 'Microservices', 'System Design',
                'Team Management', 'Git', 'TDD'
            ];
            const found = allSkills.filter(skill => 
                input.toLowerCase().includes(skill.toLowerCase())
            );
            return found.length >= 8 ? found.slice(0, 12) : allSkills.slice(0, 12);
        }
        
        function generateSummary(input, focus, experience) {
            const summaries = {
                'Technical Skills & Architecture': `Results-driven Software Engineer with ${experience} of experience designing and implementing scalable, high-performance applications. Deep expertise in modern technology stacks including React, Node.js, and cloud infrastructure. Proven track record of architecting systems that serve millions of users while maintaining 99.9% uptime.`,
                
                'Leadership & Team Management': `Strategic technical leader with ${experience} of experience building and mentoring high-performing engineering teams. Skilled at driving technical vision, establishing best practices, and delivering complex projects on time. Experienced in scaling teams from 5 to 20+ engineers while maintaining code quality and team velocity.`,
                
                'Achievements & Metrics': `High-impact engineer with ${experience} of quantifiable achievements in performance optimization, cost reduction, and user growth. Track record includes reducing infrastructure costs by 40%, improving application performance by 200%, and scaling systems to support 10M+ users. Data-driven problem solver focused on measurable business outcomes.`,
                
                'Problem-Solving & Innovation': `Creative problem-solver with ${experience} of experience identifying technical challenges and implementing innovative solutions. Skilled at analyzing complex systems, proposing elegant architectures, and executing solutions that improve efficiency by 50%+. Passionate about emerging technologies and continuous learning.`,
                
                'Collaboration & Communication': `Collaborative engineer with ${experience} of experience working across cross-functional teams. Excellent communicator skilled at translating technical concepts for non-technical stakeholders. Proven ability to build consensus, mentor junior developers, and foster a culture of knowledge sharing and continuous improvement.`
            };
            
            return summaries[focus] || summaries['Technical Skills & Architecture'];
        }
        
        function generateExperience(input, focus, pages) {
            const baseJobs = [
                {
                    title: 'Senior Software Engineer',
                    company: 'TechCorp Inc.',
                    dates: 'January 2021 - Present',
                    bullets: [
                        'Architected and deployed microservices infrastructure serving 2M+ daily active users, achieving 99.95% uptime',
                        'Led team of 6 engineers in migrating legacy monolith to modern React/Node.js stack, reducing page load time by 60%',
                        'Implemented CI/CD pipelines reducing deployment time from 2 hours to 15 minutes and increasing release frequency by 300%',
                        'Reduced AWS infrastructure costs by $200K annually through optimization and rightsizing of cloud resources'
                    ]
                },
                {
                    title: 'Software Engineer',
                    company: 'StartupXYZ',
                    dates: 'June 2019 - December 2020',
                    bullets: [
                        'Developed full-stack features for B2B SaaS platform using React, Node.js, and PostgreSQL',
                        'Built real-time analytics dashboard processing 100K+ events per second using Redis and WebSockets',
                        'Improved API response time by 45% through database query optimization and caching strategies',
                        'Collaborated with product team to define technical requirements and deliver features on aggressive timelines'
                    ]
                }
            ];
            
            // Add more experience for 2+ page resumes
            if (pages >= 2) {
                baseJobs.push({
                    title: 'Junior Software Developer',
                    company: 'Digital Agency Co.',
                    dates: 'August 2017 - May 2019',
                    bullets: [
                        'Developed responsive web applications for clients using React, Vue.js, and modern CSS frameworks',
                        'Participated in agile sprints, code reviews, and pair programming sessions to ensure code quality',
                        'Integrated third-party APIs including payment gateways, CRM systems, and marketing automation tools',
                        'Received "Rising Star" award for exceptional contribution to team productivity and client satisfaction'
                    ]
                });
            }
            
            return baseJobs;
        }
        
        function downloadResume(index) {
            alert(`Download Resume #${index}\n\nIn production, this will:\n‚úì Export as ATS-friendly PDF\n‚úì Export as DOCX format\n‚úì Include plain text version\n‚úì Optimize for Applicant Tracking Systems`);
        }
        
        function editResume(index) {
            alert(`Customize Resume #${index}\n\nIn production, you can:\n‚úì Edit all sections\n‚úì Reorder experience\n‚úì Add/remove bullet points\n‚úì Adjust formatting\n‚úì Save custom templates`);
        }
        
        // ========================================
        // Event Listeners
        // ========================================
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved settings and context
            loadSettings();
            
            // Enter key to send query
            document.getElementById('queryInput').addEventListener('keypress', e => {
                if (e.key === 'Enter') sendQuery();
            });
            
            // ESC key to close settings or drawer
            document.addEventListener('keydown', e => {
                if (e.key === 'Escape') {
                    if (document.getElementById('settingsOverlay').classList.contains('active')) {
                        closeSettings();
                    } else if (document.getElementById('context-drawer').classList.contains('open')) {
                        ui.toggleContext(false);
                    }
                }
            });
            
            // Click outside modal to close
            document.getElementById('settingsOverlay').addEventListener('click', e => {
                if (e.target.id === 'settingsOverlay') {
                    closeSettings();
                }
            });
        });
    </script>
</body>
</html>
